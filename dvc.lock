schema: '2.0'
stages:
  download_comments@2021-04:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-04.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-04.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-04.bz2
      md5: cb556dd19a80d28312b30e112098148b
      size: 29620494972
  prep_community2vec_data@2021-04:
    cmd: mkdir -p data/community2vec/RC_2021-04 && python -m ihop.import_data --config
      config.json c2v --top_n 10000 --exclude_top_user_perc 0.05 data/community2vec/RC_2021-04/subreddit_counts.csv
      data/community2vec/RC_2021-04/user_contexts data/raw_data/comments/RC_2021-04.bz2
      && rm data/community2vec/RC_2021-04/user_contexts/.*.crc
    deps:
    - path: data/raw_data/comments/RC_2021-04.bz2
      md5: cb556dd19a80d28312b30e112098148b
      size: 29620494972
    outs:
    - path: data/community2vec/RC_2021-04/subreddit_counts.csv
      md5: 0c13f117e42a443a97833fe56d3e9a86
      size: 171504
    - path: data/community2vec/RC_2021-04/user_contexts
      md5: 590033b119acef942f88485e706d47d6.dir
      size: 119852349
      nfiles: 2
  download_comments@2021-05:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-05.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-05.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-05.bz2
      md5: 97c8b1bd3e13b747ef8d97bcbb934957
      size: 30956683935
  prep_community2vec_data@2021-05:
    cmd: mkdir -p data/community2vec/RC_2021-05 && python -m ihop.import_data --config
      config.json c2v --top_n 10000 --exclude_top_user_perc 0.05 data/community2vec/RC_2021-05/subreddit_counts.csv
      data/community2vec/RC_2021-05/user_contexts data/raw_data/comments/RC_2021-05.bz2
      && rm data/community2vec/RC_2021-05/user_contexts/.*.crc
    deps:
    - path: data/raw_data/comments/RC_2021-05.bz2
      md5: 97c8b1bd3e13b747ef8d97bcbb934957
      size: 30956683935
    outs:
    - path: data/community2vec/RC_2021-05/subreddit_counts.csv
      md5: 06b106f2d767e123e4258c4068c848c2
      size: 171912
    - path: data/community2vec/RC_2021-05/user_contexts
      md5: c64755fb6e13fa5f3d4090aed37073f7.dir
      size: 123824517
      nfiles: 2
  download_comments@2021-06:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-06.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-06.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-06.bz2
      md5: d71768aef221928ab802c290cf010cc6
      size: 29759838678
  download_submissions@2021-06:
    cmd: curl https://files.pushshift.io/reddit/submissions/RS_2021-06.zst | unzstd
      --long=31 | bzip2 > data/raw_data/submissions/RS_2021-06.bz2
    outs:
    - path: data/raw_data/submissions/RS_2021-06.bz2
      md5: 182ac21bc9dd472f9b6675c2e7737e4b
      size: 6129995031
  community2vec_models@2021-04:
    cmd: "python -m ihop.community2vec --config config.json --contexts data/community2vec/RC_2021-04/user_contexts\
      \ --vocab_csv data/community2vec/RC_2021-04/subreddit_counts.csv --param_grid\
      \ '{\"alpha\": [0.08, 0.05], \"vector_size\":[100], \"sample\":[0, 0.001, 0.005],\
      \ \"negative\":[10,20]}' --epochs 5 --output_dir data/community2vec/RC_2021-04\
      \ --workers 3"
    deps:
    - path: data/community2vec/RC_2021-04/subreddit_counts.csv
      md5: 0c13f117e42a443a97833fe56d3e9a86
      size: 171504
    - path: data/community2vec/RC_2021-04/user_contexts
      md5: 590033b119acef942f88485e706d47d6.dir
      size: 119852349
      nfiles: 2
    outs:
    - path: data/community2vec/RC_2021-04/analogy_accuracy_results.csv
      md5: 2f0f155b78e2b3afeca2f390ef552fc2
      size: 4458
    - path: data/community2vec/RC_2021-04/best_model/keyedVectors
      md5: 409a58af961d8407ac03827c5e48e20d
      size: 4378233
    - path: data/community2vec/RC_2021-04/best_model/metrics.json
      md5: 77daa2f81f32c80ae6213a0de565e3dd
      size: 620
    - path: data/community2vec/RC_2021-04/best_model/parameters.json
      md5: 25c4765f14c1ee17909a22bb0c02eed1
      size: 301
    - path: data/community2vec/RC_2021-04/best_model/word2vec.pickle
      md5: a05a7f29c099048775bc074285670705
      size: 8382952
  community2vec_models@2021-05:
    cmd: "python -m ihop.community2vec --config config.json --contexts data/community2vec/RC_2021-05/user_contexts\
      \ --vocab_csv data/community2vec/RC_2021-05/subreddit_counts.csv --param_grid\
      \ '{\"alpha\": [0.08, 0.05], \"vector_size\":[100], \"sample\":[0, 0.001, 0.005],\
      \ \"negative\":[10,20]}' --epochs 5 --output_dir data/community2vec/RC_2021-05\
      \ --workers 3"
    deps:
    - path: data/community2vec/RC_2021-05/subreddit_counts.csv
      md5: 06b106f2d767e123e4258c4068c848c2
      size: 171912
    - path: data/community2vec/RC_2021-05/user_contexts
      md5: c64755fb6e13fa5f3d4090aed37073f7.dir
      size: 123824517
      nfiles: 2
    outs:
    - path: data/community2vec/RC_2021-05/analogy_accuracy_results.csv
      md5: c516c9047fee1bc02dceba99020659b2
      size: 4458
    - path: data/community2vec/RC_2021-05/best_model/keyedVectors
      md5: 3820bcdf0b990cf8cc62af510639e366
      size: 4378552
    - path: data/community2vec/RC_2021-05/best_model/metrics.json
      md5: b3d345bd20acaeb2f780c39325551c52
      size: 620
    - path: data/community2vec/RC_2021-05/best_model/parameters.json
      md5: 10809c364437b24249b2401643c448c2
      size: 301
    - path: data/community2vec/RC_2021-05/best_model/word2vec.pickle
      md5: c5db00abe7c42cb9f2aaba8276cb1211
      size: 8383271
  prep_community2vec_data@2021-06:
    cmd: mkdir -p data/community2vec/RC_2021-06 && python -m ihop.import_data --config
      config.json c2v --top_n 10000 --exclude_top_user_perc 0.05 data/community2vec/RC_2021-06/subreddit_counts.csv
      data/community2vec/RC_2021-06/user_contexts data/raw_data/comments/RC_2021-06.bz2
      && rm data/community2vec/RC_2021-06/user_contexts/.*.crc
    deps:
    - path: data/raw_data/comments/RC_2021-06.bz2
      md5: d71768aef221928ab802c290cf010cc6
      size: 29759838678
    outs:
    - path: data/community2vec/RC_2021-06/subreddit_counts.csv
      md5: 76ba452be953f30d1f4352f27fae631a
      size: 172266
    - path: data/community2vec/RC_2021-06/user_contexts
      md5: 96ae5d5f2048c17e10123fa11165693d.dir
      size: 121054533
      nfiles: 2
  community2vec_models@2021-06:
    cmd: "python -m ihop.community2vec --config config.json --contexts data/community2vec/RC_2021-06/user_contexts\
      \ --vocab_csv data/community2vec/RC_2021-06/subreddit_counts.csv --param_grid\
      \ '{\"alpha\": [0.08, 0.05], \"vector_size\":[100], \"sample\":[0, 0.001, 0.005],\
      \ \"negative\":[10,20]}' --epochs 5 --output_dir data/community2vec/RC_2021-06\
      \ --workers 3"
    deps:
    - path: data/community2vec/RC_2021-06/subreddit_counts.csv
      md5: 76ba452be953f30d1f4352f27fae631a
      size: 172266
    - path: data/community2vec/RC_2021-06/user_contexts
      md5: 96ae5d5f2048c17e10123fa11165693d.dir
      size: 121054533
      nfiles: 2
    outs:
    - path: data/community2vec/RC_2021-06/analogy_accuracy_results.csv
      md5: 9b272a4ad02f7e5948e45b223ff2219c
      size: 4445
    - path: data/community2vec/RC_2021-06/best_model/keyedVectors
      md5: 2df94373fbd7be5e84e9de8c598d48d0
      size: 4379056
    - path: data/community2vec/RC_2021-06/best_model/metrics.json
      md5: 436bf95bfba2868dcad7bf34cf73bcda
      size: 627
    - path: data/community2vec/RC_2021-06/best_model/parameters.json
      md5: f90b5c62e994972f9c54e364f8fdbad7
      size: 305
    - path: data/community2vec/RC_2021-06/best_model/word2vec.pickle
      md5: bfad54ed3cffb04e1a7da7ac922ad86f
      size: 8383792
  download_submissions@2021-04:
    cmd: curl https://files.pushshift.io/reddit/submissions/RS_2021-04.zst | unzstd
      --long=31 | bzip2 > data/raw_data/submissions/RS_2021-04.bz2
    outs:
    - path: data/raw_data/submissions/RS_2021-04.bz2
      md5: c1cca0b80dfff3bbe466bba082a77670
      size: 7495667061
  download_submissions@2021-05:
    cmd: curl https://files.pushshift.io/reddit/submissions/RS_2021-05.zst | unzstd
      --long=31 | bzip2 > data/raw_data/submissions/RS_2021-05.bz2
    outs:
    - path: data/raw_data/submissions/RS_2021-05.bz2
      md5: 6c751e1488a16f7f0003b0fa342ad0eb
      size: 4677172479
  download_comments@2021-12:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-12.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-12.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-12.bz2
      md5: dd1d4d216f5dd4e3c311ba2a0827c040
      size: 34569221614
  prep_community2vec_data@2021-12:
    cmd: mkdir -p data/community2vec/RC_2021-12 && python -m ihop.import_data --config
      config.json c2v --top_n 10000 --exclude_top_user_perc 0.05 data/community2vec/RC_2021-12/subreddit_counts.csv
      data/community2vec/RC_2021-12/user_contexts data/raw_data/comments/RC_2021-12.bz2
      && rm data/community2vec/RC_2021-12/user_contexts/.*.crc
    deps:
    - path: data/raw_data/comments/RC_2021-12.bz2
      md5: dd1d4d216f5dd4e3c311ba2a0827c040
      size: 34569221614
    outs:
    - path: data/community2vec/RC_2021-12/subreddit_counts.csv
      md5: 26d6b27f1ee7df5105fe90d9a8b92ac1
      size: 172380
    - path: data/community2vec/RC_2021-12/user_contexts
      md5: 5668d09d29d78502b623057748eec150.dir
      size: 140059495
      nfiles: 2
  community2vec_models@2021-12:
    cmd: "python -m ihop.community2vec --config config.json --contexts data/community2vec/RC_2021-12/user_contexts\
      \ --vocab_csv data/community2vec/RC_2021-12/subreddit_counts.csv --param_grid\
      \ '{\"alpha\": [0.08, 0.05], \"vector_size\":[100], \"sample\":[0, 0.001, 0.005],\
      \ \"negative\":[10,20]}' --epochs 5 --output_dir data/community2vec/RC_2021-12\
      \ --workers 3"
    deps:
    - path: data/community2vec/RC_2021-12/subreddit_counts.csv
      md5: 26d6b27f1ee7df5105fe90d9a8b92ac1
      size: 172380
    - path: data/community2vec/RC_2021-12/user_contexts
      md5: 5668d09d29d78502b623057748eec150.dir
      size: 140059495
      nfiles: 2
    outs:
    - path: data/community2vec/RC_2021-12/analogy_accuracy_results.csv
      md5: e9378c4ce466d3759ec74d3683b99b57
      size: 4447
    - path: data/community2vec/RC_2021-12/best_model/keyedVectors
      md5: da0f59f2b41f47debfffa4db5ffca27a
      size: 4378681
    - path: data/community2vec/RC_2021-12/best_model/metrics.json
      md5: 7a24f959734a1b1ff8abe518da58179f
      size: 619
    - path: data/community2vec/RC_2021-12/best_model/parameters.json
      md5: c43bb0a17d74371df770459bc350b7a6
      size: 301
    - path: data/community2vec/RC_2021-12/best_model/word2vec.pickle
      md5: bbd2d599e51b55d4771efb0ccf23918f
      size: 8383399
  download_comments@2021-10:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-10.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-10.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-10.bz2
      md5: 63e4594147bbd8530f451138f51501f4
      size: 32870949756
  prep_community2vec_data@2021-10:
    cmd: mkdir -p data/community2vec/RC_2021-10 && python -m ihop.import_data --config
      config.json c2v --top_n 10000 --exclude_top_user_perc 0.05 data/community2vec/RC_2021-10/subreddit_counts.csv
      data/community2vec/RC_2021-10/user_contexts data/raw_data/comments/RC_2021-10.bz2
      && rm data/community2vec/RC_2021-10/user_contexts/.*.crc
    deps:
    - path: data/raw_data/comments/RC_2021-10.bz2
      md5: 2611f531cc2176d72d202141af859936
      size: 31769082194
    outs:
    - path: data/community2vec/RC_2021-10/subreddit_counts.csv
      md5: 56ea0bc8dd9ab40c33800a4da896dde4
      size: 172106
    - path: data/community2vec/RC_2021-10/user_contexts
      md5: d4537a6b28ac0a797b6da866e877cd4b.dir
      size: 129814371
      nfiles: 2
  community2vec_models@2021-10:
    cmd: "python -m ihop.community2vec --config config.json --contexts data/community2vec/RC_2021-10/user_contexts\
      \ --vocab_csv data/community2vec/RC_2021-10/subreddit_counts.csv --param_grid\
      \ '{\"alpha\": [0.08, 0.05], \"vector_size\":[100], \"sample\":[0, 0.001, 0.005],\
      \ \"negative\":[10,20]}' --epochs 5 --output_dir data/community2vec/RC_2021-10\
      \ --workers 3"
    deps:
    - path: data/community2vec/RC_2021-10/subreddit_counts.csv
      md5: 56ea0bc8dd9ab40c33800a4da896dde4
      size: 172106
    - path: data/community2vec/RC_2021-10/user_contexts
      md5: d4537a6b28ac0a797b6da866e877cd4b.dir
      size: 129814371
      nfiles: 2
    outs:
    - path: data/community2vec/RC_2021-10/analogy_accuracy_results.csv
      md5: 1f9d52bb1291996cc5efe0cf22222924
      size: 4457
    - path: data/community2vec/RC_2021-10/best_model/keyedVectors
      md5: 3ac655c56c73b4a17a97d404de22d4a1
      size: 4378646
    - path: data/community2vec/RC_2021-10/best_model/metrics.json
      md5: 9bf2d42a3f90d017824f1015328af907
      size: 628
    - path: data/community2vec/RC_2021-10/best_model/parameters.json
      md5: 09072507fc9e31925124e529daf30540
      size: 305
    - path: data/community2vec/RC_2021-10/best_model/word2vec.pickle
      md5: 90fd078ccc180b20cdae3c22de16cffc
      size: 8383384
  download_comments@2021-07:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-07.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-07.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-07.bz2
      md5: 47cbcb5b1d435db3d166382b0eca09b7
      size: 30911364258
  prep_community2vec_data@2021-07:
    cmd: mkdir -p data/community2vec/RC_2021-07 && python -m ihop.import_data --config
      config.json c2v --top_n 10000 --exclude_top_user_perc 0.05 data/community2vec/RC_2021-07/subreddit_counts.csv
      data/community2vec/RC_2021-07/user_contexts data/raw_data/comments/RC_2021-07.bz2
      && rm data/community2vec/RC_2021-07/user_contexts/.*.crc
    deps:
    - path: data/raw_data/comments/RC_2021-07.bz2
      md5: 5e2d0cc4af5aba146b38443bb8d791a7
      size: 11196452701
    outs:
    - path: data/community2vec/RC_2021-07/subreddit_counts.csv
      md5: ce6f4dd875b31e54f491a090eaf35af6
      size: 167081
    - path: data/community2vec/RC_2021-07/user_contexts
      md5: 9d99ea72d6fd651dc8294b533afed55a.dir
      size: 51664448
      nfiles: 2
  download_comments@2021-11:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-11.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-11.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-11.bz2
      md5: 0d4dd6fc206327e5d7984e7101cd6b1a
      size: 33307050193
  prep_community2vec_data@2021-11:
    cmd: mkdir -p data/community2vec/RC_2021-11 && python -m ihop.import_data --config
      config.json c2v --top_n 10000 --exclude_top_user_perc 0.05 data/community2vec/RC_2021-11/subreddit_counts.csv
      data/community2vec/RC_2021-11/user_contexts data/raw_data/comments/RC_2021-11.bz2
      && rm data/community2vec/RC_2021-11/user_contexts/.*.crc
    deps:
    - path: data/raw_data/comments/RC_2021-11.bz2
      md5: 0d4dd6fc206327e5d7984e7101cd6b1a
      size: 33307050193
    outs:
    - path: data/community2vec/RC_2021-11/subreddit_counts.csv
      md5: e5b88d2ff4ea0add16780d4221ca1e1e
      size: 172222
    - path: data/community2vec/RC_2021-11/user_contexts
      md5: 2212108a62b9da07704b61526a15daa0.dir
      size: 134896440
      nfiles: 2
  community2vec_models@2021-11:
    cmd: "python -m ihop.community2vec --config config.json --contexts data/community2vec/RC_2021-11/user_contexts\
      \ --vocab_csv data/community2vec/RC_2021-11/subreddit_counts.csv --param_grid\
      \ '{\"alpha\": [0.08, 0.05], \"vector_size\":[100], \"sample\":[0, 0.001, 0.005],\
      \ \"negative\":[10,20]}' --epochs 5 --output_dir data/community2vec/RC_2021-11\
      \ --workers 3"
    deps:
    - path: data/community2vec/RC_2021-11/subreddit_counts.csv
      md5: e5b88d2ff4ea0add16780d4221ca1e1e
      size: 172222
    - path: data/community2vec/RC_2021-11/user_contexts
      md5: 2212108a62b9da07704b61526a15daa0.dir
      size: 134896440
      nfiles: 2
    outs:
    - path: data/community2vec/RC_2021-11/analogy_accuracy_results.csv
      md5: 76f77162f416905dcf4254ef04190700
      size: 4458
    - path: data/community2vec/RC_2021-11/best_model/keyedVectors
      md5: ed026167603afa56e596ea021b12d83f
      size: 4378644
    - path: data/community2vec/RC_2021-11/best_model/metrics.json
      md5: 6616715bad5da03cda788a11a98e2a15
      size: 628
    - path: data/community2vec/RC_2021-11/best_model/parameters.json
      md5: 0726875803886c33aec689804d7c9a94
      size: 305
    - path: data/community2vec/RC_2021-11/best_model/word2vec.pickle
      md5: c997ae3fadf89ed069c79082f27c26b2
      size: 8383380
  download_comments@2021-09:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-09.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-09.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-09.bz2
      md5: 9b3665fc25907ecbdc7808ae4043b6bd
      size: 31996196383
  download_comments@2022-01:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2022-01.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2022-01.bz2
    outs:
    - path: data/raw_data/comments/RC_2022-01.bz2
      md5: fd25ba68de752140547aa2a0c2080320
      size: 37953945294
  download_comments@2022-03:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2022-03.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2022-03.bz2
    outs:
    - path: data/raw_data/comments/RC_2022-03.bz2
      md5: 4daa2988038a4168cc70e21b7cea96ea
      size: 35139378132
  download_comments@2021-08:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2021-08.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2021-08.bz2
    outs:
    - path: data/raw_data/comments/RC_2021-08.bz2
      md5: 2495184724809cbf0838592eac5c1459
      size: 33087814591
  download_comments@2022-02:
    cmd: curl  https://files.pushshift.io/reddit/comments/RC_2022-02.zst | unzstd
      --long=31 | bzip2 > data/raw_data/comments/RC_2022-02.bz2
    outs:
    - path: data/raw_data/comments/RC_2022-02.bz2
      md5: 693b93d28cfeaa2fd54986c785072a0d
      size: 32237946461
